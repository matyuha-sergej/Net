# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ ‚úÖ

–î–∞—Ç–∞—Å–µ—Ç —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:
- **–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `datasets/merged_ball_dataset/`
- **Train:** 1026 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (70%)
- **Val:** 293 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (20%)
- **Test:** 148 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (10%)
- **–í—Å–µ–≥–æ:** 1467 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–ö–ª–∞—Å—Å:** ball (–º—è—á)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

```
datasets/merged_ball_dataset/
‚îú‚îÄ‚îÄ data.yaml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ train/        # 1026 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ val/          # 293 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ test/         # 148 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ labels/
    ‚îú‚îÄ‚îÄ train/        # YOLO —Ä–∞–∑–º–µ—Ç–∫–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ val/          # YOLO —Ä–∞–∑–º–µ—Ç–∫–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    ‚îî‚îÄ‚îÄ test/         # YOLO —Ä–∞–∑–º–µ—Ç–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

## –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—á–∞–ª–∞)

```bash
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --model yolov8n.pt \
    --epochs 50 \
    --batch 16 \
    --name ball_detector_quick
```

**–í—Ä–µ–º—è:** ~10-20 –º–∏–Ω—É—Ç –Ω–∞ GPU, ~1-2 —á–∞—Å–∞ –Ω–∞ CPU

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ)

```bash
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --model yolov8n.pt \
    --epochs 100 \
    --batch 16 \
    --name ball_detector_full
```

**–í—Ä–µ–º—è:** ~20-40 –º–∏–Ω—É—Ç –Ω–∞ GPU, ~2-4 —á–∞—Å–∞ –Ω–∞ CPU

### –í–∞—Ä–∏–∞–Ω—Ç 3: –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–±–æ–ª—å—à–∞—è –º–æ–¥–µ–ª—å)

```bash
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --model yolov8s.pt \
    --epochs 100 \
    --batch 8 \
    --name ball_detector_enhanced
```

**–í—Ä–µ–º—è:** ~40-60 –º–∏–Ω—É—Ç –Ω–∞ GPU, ~4-6 —á–∞—Å–æ–≤ –Ω–∞ CPU

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è

- `--data` - –ø—É—Ç—å –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞
- `--model` - –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å (yolov8n/s/m/l/x)
  - `yolov8n` - nano (—Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è, ~6MB)
  - `yolov8s` - small (–±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç—å/–∫–∞—á–µ—Å—Ç–≤–æ, ~22MB)
  - `yolov8m` - medium (–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, ~52MB)
- `--epochs` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è
- `--batch` - —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (—É–º–µ–Ω—å—à–∏—Ç–µ, –µ—Å–ª–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –ø–∞–º—è—Ç–∏)
- `--name` - –∏–º—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
- `--device` - —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ('0' –¥–ª—è GPU, 'cpu' –¥–ª—è CPU)

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è

–í–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã:
- Loss (—Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å) - –¥–æ–ª–∂–Ω–∞ —É–º–µ–Ω—å—à–∞—Ç—å—Å—è
- mAP (mean Average Precision) - –¥–æ–ª–∂–Ω–∞ —Ä–∞—Å—Ç–∏
- Precision/Recall - –º–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤: `runs/detect/[name]/`

## –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤:
```
runs/detect/ball_detector_[name]/weights/best.pt
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
# –ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
.venv/bin/python cli.py test_image.jpg \
    --model runs/detect/ball_detector_quick/weights/best.pt

# –ù–∞ —Ä–µ–∞–ª—å–Ω–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
.venv/bin/python cli.py your_image.jpg \
    --model runs/detect/ball_detector_quick/weights/best.pt \
    --confidence 0.5 \
    --net-method hough
```

### 3. –ó–∞–ø—É—Å–∫ GUI —Å –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é

```bash
.venv/bin/python main.py
```

–ó–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏—Ç–µ "–°–≤–æ—è –º–æ–¥–µ–ª—å..." –∏ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ `best.pt`

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ

```bash
.venv/bin/python cli.py video.mp4 \
    --video \
    --model runs/detect/ball_detector_quick/weights/best.pt \
    --output analyzed_video.mp4
```

## –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏:

- **mAP50 > 0.90** - –æ—Ç–ª–∏—á–Ω–∞—è –º–æ–¥–µ–ª—å
- **mAP50 0.70-0.90** - —Ö–æ—Ä–æ—à–∞—è –º–æ–¥–µ–ª—å
- **mAP50 < 0.70** - –Ω—É–∂–Ω–æ —É–ª—É—á—à–µ–Ω–∏–µ

### –ï—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∏–∑–∫–æ–µ:

1. **–£–≤–µ–ª–∏—á–∏—Ç—å epochs** –¥–æ 150-200
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à—É—é –º–æ–¥–µ–ª—å** (yolov8s –∏–ª–∏ yolov8m)
3. **–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö** (–µ—Å–ª–∏ –µ—Å—Ç—å)
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–º–µ—Ç–∫–∏** (–ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

## –£–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

### –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

YOLO –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—é:
- –ü–æ–≤–æ—Ä–æ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏/–∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞
- –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û—Ç—Ä–∞–∂–µ–Ω–∏–µ

### –¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ï—Å–ª–∏ –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è (train loss –Ω–∏–∑–∫–∏–π, val loss –≤—ã—Å–æ–∫–∏–π):
```bash
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --epochs 100 \
    --batch 16 \
    --patience 50  # Early stopping
```

## –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ workflow

```bash
# 1. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --epochs 50 \
    --batch 16 \
    --name my_ball_model

# 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
.venv/bin/python cli.py test_image.jpg \
    --model runs/detect/my_ball_model/weights/best.pt

# 3. –ó–∞–ø—É—Å–∫ GUI
.venv/bin/python main.py
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å

# 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ
.venv/bin/python cli.py match.mp4 --video \
    --model runs/detect/my_ball_model/weights/best.pt
```

## Troubleshooting

### –û—à–∏–±–∫–∞ "Out of memory"
```bash
# –£–º–µ–Ω—å—à–∏—Ç–µ batch size
.venv/bin/python train_yolo.py --batch 8  # –≤–º–µ—Å—Ç–æ 16
```

### –û–±—É—á–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ–µ
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à—É—é –º–æ–¥–µ–ª—å
.venv/bin/python train_yolo.py --model yolov8n.pt
```

### –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏
```bash
# –û–±—É—á–∏—Ç–µ –¥–æ–ª—å—à–µ —Å –±–æ–ª—å—à–µ–π –º–æ–¥–µ–ª—å—é
.venv/bin/python train_yolo.py \
    --model yolov8s.pt \
    --epochs 150 \
    --batch 8
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç–µ –±–æ–ª—å—à–µ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤:
```bash
# –ü–µ—Ä–µ–ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç
.venv/bin/python prepare_dataset.py --yes

# –û–±—É—á–∏—Ç—å –∑–∞–Ω–æ–≤–æ
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --epochs 100
```

### –≠–∫—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö:
```bash
from ultralytics import YOLO

model = YOLO('runs/detect/my_ball_model/weights/best.pt')
model.export(format='onnx')  # –∏–ª–∏ 'tflite', 'coreml'
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –î–∞—Ç–∞—Å–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω
2. ‚¨ú –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ (50 —ç–ø–æ—Ö)
3. ‚¨ú –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö
4. ‚¨ú –ï—Å–ª–∏ –Ω—É–∂–Ω–æ - –æ–±—É—á–∏—Ç–µ –¥–æ–ª—å—à–µ –∏–ª–∏ —Å –±–æ–ª—å—à–µ–π –º–æ–¥–µ–ª—å—é
5. ‚¨ú –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

–£–¥–∞—á–∏ –≤ –æ–±—É—á–µ–Ω–∏–∏! üöÄ
