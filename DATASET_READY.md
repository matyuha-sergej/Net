# ‚úÖ –î–∞—Ç–∞—Å–µ—Ç –≥–æ—Ç–æ–≤ –∫ –æ–±—É—á–µ–Ω–∏—é!

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

- **–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã:** 24 –ø–∞–ø–∫–∏
- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:** 1467
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
  - üü¢ Train: 1026 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (70%)
  - üü° Validation: 293 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (20%)
  - üîµ Test: 148 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (10%)

## üìÅ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ

```
datasets/merged_ball_dataset/
‚îú‚îÄ‚îÄ data.yaml              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è YOLO
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ train/            # 1026 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ val/              # 293 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ test/             # 148 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îî‚îÄ‚îÄ labels/
    ‚îú‚îÄ‚îÄ train/            # –†–∞–∑–º–µ—Ç–∫–∞ YOLO
    ‚îú‚îÄ‚îÄ val/              # –†–∞–∑–º–µ—Ç–∫–∞ YOLO
    ‚îî‚îÄ‚îÄ test/             # –†–∞–∑–º–µ—Ç–∫–∞ YOLO
```

## üöÄ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
./start_training.sh
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤—ã–±—Ä–∞—Ç—å:
1. –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ (50 —ç–ø–æ—Ö)
2. –ü–æ–ª–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (100 —ç–ø–æ—Ö)
3. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–±–æ–ª—å—à–∞—è –º–æ–¥–µ–ª—å)
4. –°–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º–∞—è –∫–æ–º–∞–Ω–¥–∞

#### –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–¥–ª—è –Ω–∞—á–∞–ª–∞)
```bash
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --epochs 50 \
    --batch 16 \
    --name ball_detector_quick
```

#### –ü–æ–ª–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --epochs 100 \
    --batch 16 \
    --name ball_detector
```

## ‚è±Ô∏è –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è

| –í–∞—Ä–∏–∞–Ω—Ç | GPU | CPU |
|---------|-----|-----|
| –ë—ã—Å—Ç—Ä–æ–µ (50 —ç–ø–æ—Ö, yolov8n) | 10-20 –º–∏–Ω | 1-2 —á–∞—Å–∞ |
| –ü–æ–ª–Ω–æ–µ (100 —ç–ø–æ—Ö, yolov8n) | 20-40 –º–∏–Ω | 2-4 —á–∞—Å–∞ |
| –£–ª—É—á—à–µ–Ω–Ω–æ–µ (100 —ç–ø–æ—Ö, yolov8s) | 40-60 –º–∏–Ω | 4-6 —á–∞—Å–æ–≤ |

## üìà –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è

1. –ó–∞–≥—Ä—É–∑–∏—Ç—Å—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å YOLOv8
2. –ù–∞—á–Ω–µ—Ç—Å—è –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
3. –ö–∞–∂–¥—É—é —ç–ø–æ—Ö—É –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –º–µ—Ç—Ä–∏–∫–∏:
   - **Loss** - —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (–¥–æ–ª–∂–Ω–∞ —É–º–µ–Ω—å—à–∞—Ç—å—Å—è)
   - **mAP** - —Ç–æ—á–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏ (–¥–æ–ª–∂–Ω–∞ —Ä–∞—Å—Ç–∏)
   - **Precision/Recall** - –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `runs/detect/[–∏–º—è_—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞]/`

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è

–í–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–æ:
```
Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
  1/100      4.51G      1.234      0.567      1.123         32        640
  2/100      4.51G      1.123      0.456      1.012         32        640
  ...
```

## ‚úÖ –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è

### 1. –ù–∞–π–¥–∏—Ç–µ –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å

–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å:
```
runs/detect/[–∏–º—è_—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞]/weights/best.pt
```

–ü–æ—Å–ª–µ–¥–Ω—è—è –º–æ–¥–µ–ª—å:
```
runs/detect/[–∏–º—è_—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞]/weights/last.pt
```

### 2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–æ–¥–µ–ª—å

```bash
# –ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
.venv/bin/python cli.py test_image.jpg \
    --model runs/detect/ball_detector/weights/best.pt

# –ù–∞ –≤–∞—à–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
.venv/bin/python cli.py –≤–∞—à–µ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.jpg \
    --model runs/detect/ball_detector/weights/best.pt \
    --confidence 0.5 \
    --net-method hough
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ GUI

```bash
.venv/bin/python main.py
```

–í GUI:
1. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
2. –í "–ú–æ–¥–µ–ª—å YOLO" –≤—ã–±–µ—Ä–∏—Ç–µ "–°–≤–æ—è –º–æ–¥–µ–ª—å..."
3. –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ `runs/detect/ball_detector/weights/best.pt`
4. –ù–∞–∂–º–∏—Ç–µ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å"

### 4. –û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –≤–∏–¥–µ–æ

```bash
.venv/bin/python cli.py –≤–∏–¥–µ–æ.mp4 \
    --video \
    --model runs/detect/ball_detector/weights/best.pt \
    --output —Ä–µ–∑—É–ª—å—Ç–∞—Ç.mp4
```

## üéØ –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ñ–∞–π–ª–µ:
```
runs/detect/[–∏–º—è]/results.csv
```

**–•–æ—Ä–æ—à–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:**
- mAP50 > 0.85 ‚úÖ
- Precision > 0.80 ‚úÖ
- Recall > 0.75 ‚úÖ

**–ï—Å–ª–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∏–∂–µ:**
- –û–±—É—á–∏—Ç–µ –¥–æ–ª—å—à–µ (150-200 —ç–ø–æ—Ö)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª—å—à—É—é –º–æ–¥–µ–ª—å (yolov8s –∏–ª–∏ yolov8m)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–º–µ—Ç–∫–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- `TRAINING_GUIDE.md` - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–±—É—á–µ–Ω–∏—é
- `EXAMPLES.md` - –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `README.md` - –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üí° –°–æ–≤–µ—Ç—ã

1. **–ù–∞—á–Ω–∏—Ç–µ —Å –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è** (50 —ç–ø–æ—Ö) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
2. **–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ö–æ—Ä–æ—à–∏–π** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å
3. **–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å** - –æ–±—É—á–∏—Ç–µ –¥–æ–ª—å—à–µ –∏–ª–∏ –Ω–∞ –±–æ–ª—å—à–µ–π –º–æ–¥–µ–ª–∏
4. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ª—É—á—à–∏–µ –º–æ–¥–µ–ª–∏** –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

## üÜò –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### Out of memory (–Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –ø–∞–º—è—Ç–∏)
```bash
# –£–º–µ–Ω—å—à–∏—Ç–µ batch size
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --batch 8  # –≤–º–µ—Å—Ç–æ 16
```

### –°–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–µ —ç–ø–æ—Ö
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --epochs 30
```

### –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
```bash
# –û–±—É—á–∏—Ç–µ –¥–æ–ª—å—à–µ —Å –±–æ–ª—å—à–µ–π –º–æ–¥–µ–ª—å—é
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --model yolov8s.pt \
    --epochs 150 \
    --batch 8
```

---

## üé¨ –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ
./start_training.sh

# –ò–ª–∏ –ø—Ä—è–º–æ–π –∫–æ–º–∞–Ω–¥–æ–π
.venv/bin/python train_yolo.py \
    --data datasets/merged_ball_dataset/data.yaml \
    --epochs 50 \
    --batch 16 \
    --name my_ball_detector
```

–£–¥–∞—á–∏ –≤ –æ–±—É—á–µ–Ω–∏–∏! üöÄ‚öΩüéæ
