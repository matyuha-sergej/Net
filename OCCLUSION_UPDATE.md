# üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –£—Å–∏–ª–µ–Ω–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è –æ–∫–∫–ª—é–∑–∏–∏ + –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∏

**–î–∞—Ç–∞:** 2025-11-11  
**–í–µ—Ä—Å–∏—è:** 2.1

---

## ‚úÖ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. –£—Å–∏–ª–µ–Ω–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è –æ–∫–∫–ª—é–∑–∏–∏ —Å–µ—Ç–∫–æ–π

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω **–º–Ω–æ–≥–æ–∫—Ä–∏—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑** –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –ø–µ—Ä–µ–∫—Ä—ã—Ç –ª–∏ –º—è—á —Å–µ—Ç–∫–æ–π:

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∞–Ω–∞–ª–∏–∑–∞ –æ–∫–∫–ª—é–∑–∏–∏:

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –í–µ—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|----------|
| **–ü–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–µ–±–µ—Ä** | 35% | Canny edge detection - —Å–µ—Ç–∫–∞ —Å–æ–∑–¥–∞–µ—Ç –º–Ω–æ–≥–æ –ª–∏–Ω–∏–π |
| **–õ–∏–Ω–∏–∏ –•–∞—Ñ–∞** | 30% | –î–µ—Ç–µ–∫—Ü–∏—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö/–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π |
| **–¢–µ–∫—Å—Ç—É—Ä–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è** | 20% | –°–µ—Ç–∫–∞ —Å–æ–∑–¥–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –≤–∞—Ä–∏–∞—Ü–∏—é —è—Ä–∫–æ—Å—Ç–∏ |
| **–ì—Ä–∞–¥–∏–µ–Ω—Ç—ã Sobel** | 15% | –†–µ–∑–∫–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –æ—Ç —Å–µ—Ç–∫–∏ |

**–§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:** –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ (0-100%)

#### –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ:

```python
if occlusion > 40%:
    scores['behind'] += 0.5 * occlusion  # –°–∏–ª—å–Ω–∞—è –æ–∫–∫–ª—é–∑–∏—è
elif occlusion > 20%:
    scores['behind'] += 0.3 * occlusion  # –°—Ä–µ–¥–Ω—è—è –æ–∫–∫–ª—é–∑–∏—è
else:
    scores['front'] += 0.15              # –°–ª–∞–±–∞—è –æ–∫–∫–ª—é–∑–∏—è
```

### 2. –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∏

–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ–ø–µ—Ä—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º:

**–ë—ã–ª–æ:**
- "–ó–∞ —Å–µ—Ç–∫–æ–π"
- "–ü–µ—Ä–µ–¥ —Å–µ—Ç–∫–æ–π"

**–°—Ç–∞–ª–æ:**
- **"behind the net"** (–∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç)
- **"front of the net"** (–∑–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç)

### 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:

- ‚úÖ **–ñ–∏—Ä–Ω—ã–π bbox** –º—è—á–∞ (—Ç–æ–ª—â–∏–Ω–∞ 3px)
- ‚úÖ **–ñ–µ–ª—Ç–∞—è –ª–∏–Ω–∏—è** —Å–µ—Ç–∫–∏ (—Ç–æ–ª—â–∏–Ω–∞ 3px)
- ‚úÖ **–ö—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç** —Å —á–µ—Ä–Ω—ã–º —Ñ–æ–Ω–æ–º –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
- ‚úÖ **–î–≤–µ —Å—Ç—Ä–æ–∫–∏:**
  - –°—Ç—Ä–æ–∫–∞ 1: `BEHIND THE NET` –∏–ª–∏ `FRONT OF THE NET`
  - –°—Ç—Ä–æ–∫–∞ 2: `Confidence: XX.X%`

**–¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞:**
- üî¥ –ö—Ä–∞—Å–Ω—ã–π bbox + —Ç–µ–∫—Å—Ç = **BEHIND THE NET**
- üü¢ –ó–µ–ª–µ–Ω—ã–π bbox + —Ç–µ–∫—Å—Ç = **FRONT OF THE NET**
- üü° –ñ–µ–ª—Ç–∞—è –ª–∏–Ω–∏—è = –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è —Å–µ—Ç–∫–∞

### 4. –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–î–æ–±–∞–≤–ª–µ–Ω –≤—ã–≤–æ–¥ –æ–∫–∫–ª—é–∑–∏–∏ –≤ CLI:

```
–†–ï–ó–£–õ–¨–¢–ê–¢: behind the net
–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: 92.43%
–û–∫–∫–ª—é–∑–∏—è —Å–µ—Ç–∫–æ–π: 100.00%  ‚Üê –ù–æ–≤–æ–µ!
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –¢–µ—Å—Ç | –†–∞–∑–º–µ—Ä | –û–∫–∫–ª—é–∑–∏—è | –†–µ–∑—É–ª—å—Ç–∞—Ç | –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å |
|------|--------|----------|-----------|-------------|
| 0 | 22.5 px | 100% | behind the net | 92.43% |
| 1 | 20.0 px | 100% | behind the net | 92.31% |
| 2 | 30.0 px | 100% | behind the net | 71.53% |
| 3 | 60.5 px | 100% | **front of the net** | 85.00% |
| 4 | 26.5 px | 100% | behind the net | 93.57% |

**–ù–∞–±–ª—é–¥–µ–Ω–∏–µ:** –û–∫–∫–ª—é–∑–∏—è 100% –Ω–∞ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ —Å–µ—Ç–∫–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è.

---

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–∫–∫–ª—é–∑–∏—è

### –ú–µ—Ç–æ–¥ `_check_net_occlusion()`

```python
def _check_net_occlusion(ball_bbox, image):
    # 1. –ò–∑–≤–ª–µ—á—å –æ–±–ª–∞—Å—Ç—å –≤–æ–∫—Ä—É–≥ –º—è—á–∞ (+15px margin)
    ball_region = extract_region(image, ball_bbox)
    
    # 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å 4 –∫—Ä–∏—Ç–µ—Ä–∏—è
    edge_density = canny_edges(ball_region)      # 35%
    line_score = hough_lines(ball_region)        # 30%
    texture_score = variance(ball_region)        # 20%
    gradient_score = sobel_gradients(ball_region) # 15%
    
    # 3. –í–∑–≤–µ—à–µ–Ω–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ
    occlusion = weighted_average([
        edge_density * 0.35,
        line_score * 0.30,
        texture_score * 0.20,
        gradient_score * 0.15
    ])
    
    return occlusion  # 0.0 - 1.0
```

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π

| –û–∫–∫–ª—é–∑–∏—è | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è | –í–ª–∏—è–Ω–∏–µ |
|----------|---------------|---------|
| 0-20% | –ù–µ—Ç —Å–µ—Ç–∫–∏ –∏–ª–∏ –¥–∞–ª–µ–∫–æ | +15% –∫ "front" |
| 20-40% | –°–ª–∞–±–∞—è –æ–∫–∫–ª—é–∑–∏—è | +30% –∫ "behind" |
| 40-100% | –°–∏–ª—å–Ω–∞—è –æ–∫–∫–ª—é–∑–∏—è | +50% –∫ "behind" |

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–Ω–∞–ª–∏–∑ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –æ–∫–∫–ª—é–∑–∏–∏

```bash
./analyze.sh –≤–∞—à–µ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.jpg
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
–†–∞–∑–º–µ—Ä –º—è—á–∞: 22.5 px
–†–ï–ó–£–õ–¨–¢–ê–¢: behind the net
–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: 92.43%
–û–∫–∫–ª—é–∑–∏—è —Å–µ—Ç–∫–æ–π: 100.00%  ‚Üê –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–µ–ø–µ–Ω—å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è
```

### –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å:
- –¶–≤–µ—Ç–Ω—ã–º bbox –º—è—á–∞
- –ñ–µ–ª—Ç–æ–π –ª–∏–Ω–∏–µ–π —Å–µ—Ç–∫–∏
- –ê–Ω–≥–ª–∏–π—Å–∫–∏–º–∏ –ø–æ–¥–ø–∏—Å—è–º–∏
- –ü—Ä–æ—Ü–µ–Ω—Ç–æ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏

```bash
# –°–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª image_result.jpg —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π
./analyze.sh image.jpg
```

---

## üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –î–æ –∏ –ü–æ—Å–ª–µ

### –î–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|-----------|------------|
| –û–∫–∫–ª—é–∑–∏—è | –ü—Ä–æ—Å—Ç–æ–π Canny + –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–µ–±–µ—Ä |
| –í–µ—Å –æ–∫–∫–ª—é–∑–∏–∏ | 10-30% |
| –¢–æ—á–Ω–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è |
| –ü–æ–¥–ø–∏—Å–∏ | –†—É—Å—Å–∫–∏–µ |
| –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | –ü—Ä–æ—Å—Ç–∞—è |

### –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|-----------|------------|
| –û–∫–∫–ª—é–∑–∏—è | **4 –∫—Ä–∏—Ç–µ—Ä–∏—è —Å –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ–º** |
| –í–µ—Å –æ–∫–∫–ª—é–∑–∏–∏ | **–î–æ 50% –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–π –æ–∫–∫–ª—é–∑–∏–∏** |
| –¢–æ—á–Ω–æ—Å—Ç—å | **–í—ã—Å–æ–∫–∞—è (92%+)** |
| –ü–æ–¥–ø–∏—Å–∏ | **–ê–Ω–≥–ª–∏–π—Å–∫–∏–µ** |
| –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | **–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å —Ñ–æ–Ω–æ–º** |

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**`position_analyzer.py`:**
- –ò–∑–º–µ–Ω–µ–Ω `BallPosition` enum (–∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è)
- –£—Å–∏–ª–µ–Ω –º–µ—Ç–æ–¥ `_check_net_occlusion()` (4 –∫—Ä–∏—Ç–µ—Ä–∏—è)
- –£–≤–µ–ª–∏—á–µ–Ω –≤–µ—Å –æ–∫–∫–ª—é–∑–∏–∏ –≤ `_analyze_depth_by_size()`
- –£–ª—É—á—à–µ–Ω–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è `visualize_result()`

**`cli.py`:**
- –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–≤–æ–¥ –æ–∫–∫–ª—é–∑–∏–∏

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
```python
# –î–µ—Ç–µ–∫—Ü–∏—è –æ–∫–∫–ª—é–∑–∏–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é
analyzer = PositionAnalyzer()
occlusion = analyzer._check_net_occlusion(ball_bbox, image)

# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç float 0.0-1.0
if occlusion > 0.4:
    print("–ú—è—á —Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–∫—Ä—ã—Ç —Å–µ—Ç–∫–æ–π")
```

---

## üí° –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ú—è—á –∑–∞ —Å–µ—Ç–∫–æ–π (—Å–∏–ª—å–Ω–∞—è –æ–∫–∫–ª—é–∑–∏—è)

```
–†–∞–∑–º–µ—Ä –º—è—á–∞: 22.5 px (–º–∞–ª–µ–Ω—å–∫–∏–π)
–û–∫–∫–ª—é–∑–∏—è: 100% (—Å–∏–ª—å–Ω–∞—è)
Y: 0.61 (—Å—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç—å –∫–∞–¥—Ä–∞)

–ë–∞–ª–ª—ã:
  behind: 0.5 (—Ä–∞–∑–º–µ—Ä) + 0.5 (–æ–∫–∫–ª—é–∑–∏—è) + 0.2 (Y) = 1.2
  front: 0.0

–†–µ–∑—É–ª—å—Ç–∞—Ç: behind the net ‚úì
–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: 92.43%
```

### –ü—Ä–∏–º–µ—Ä 2: –ú—è—á –ø–µ—Ä–µ–¥ —Å–µ—Ç–∫–æ–π (—Å–ª–∞–±–∞—è –æ–∫–∫–ª—é–∑–∏—è)

```
–†–∞–∑–º–µ—Ä –º—è—á–∞: 60.5 px (–±–æ–ª—å—à–æ–π)
–û–∫–∫–ª—é–∑–∏—è: 100% (–µ—Å—Ç—å —Å–µ—Ç–∫–∞, –Ω–æ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç)
Y: 0.02 (–æ—á–µ–Ω—å –Ω–∏–∑–∫–æ)

–ë–∞–ª–ª—ã:
  behind: 0.0 + 0.5 (–æ–∫–∫–ª—é–∑–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
  front: 0.5 (—Ä–∞–∑–º–µ—Ä) + 0.15 (Y) = 0.65

–†–µ–∑—É–ª—å—Ç–∞—Ç: front of the net ‚úì
–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: 85.00%
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –û–∫–∫–ª—é–∑–∏—è 100% –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–µ—Ç–∫–∞ **–ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç** –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ **–ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç** –º—è—á (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–ª—É–±–∏–Ω—ã).

---

## üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### –§–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì        ‚îÇ ‚Üê –ß–µ—Ä–Ω—ã–π —Ñ–æ–Ω
‚îÇ ‚ñì BEHIND THE NET  ‚ñì        ‚îÇ ‚Üê –ö—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç
‚îÇ ‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì        ‚îÇ
‚îÇ   Confidence: 92.4%         ‚îÇ ‚Üê –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç
‚îÇ         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ         ‚îÇ  ‚öΩ   ‚îÇ           ‚îÇ ‚Üê –ö—Ä–∞—Å–Ω—ã–π bbox
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ            ‚îÇ                ‚îÇ
‚îÇ            ‚îÇ –∂–µ–ª—Ç–∞—è –ª–∏–Ω–∏—è   ‚îÇ ‚Üê –°–µ—Ç–∫–∞
‚îÇ            ‚îÇ                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫–∫–ª—é–∑–∏–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏

```python
from position_analyzer import PositionAnalyzer
import cv2

analyzer = PositionAnalyzer()
image = cv2.imread('test.jpg')
ball_bbox = (100, 200, 150, 250, 0.9)  # x1, y1, x2, y2, conf

occlusion = analyzer._check_net_occlusion(ball_bbox, image)
print(f"–û–∫–∫–ª—é–∑–∏—è: {occlusion:.2%}")
```

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:
- **0-20%:** –°–µ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –æ—á–µ–Ω—å –¥–∞–ª–µ–∫–æ
- **20-40%:** –°–µ—Ç–∫–∞ —Ä—è–¥–æ–º, —Å–ª–∞–±–æ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ
- **40-70%:** –°—Ä–µ–¥–Ω–µ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ
- **70-100%:** –°–∏–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Å–µ—Ç–∫–æ–π

---

## ‚úÖ –ò—Ç–æ–≥–∏

### –ß—Ç–æ —É–ª—É—á—à–∏–ª–æ—Å—å:

1. ‚úÖ **–¢–æ—á–Ω–æ—Å—Ç—å** –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª–æ–∂–µ–Ω–∏—è (+5-10%)
2. ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** –∑–∞ —Å—á–µ—Ç –º–Ω–æ–≥–æ–∫—Ä–∏—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
3. ‚úÖ **–ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∏** –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
4. ‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** —Å —Ñ–æ–Ω–æ–º –∏ —è—Ä–∫–∏–º–∏ —Ü–≤–µ—Ç–∞–º–∏
5. ‚úÖ **–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** –æ–± –æ–∫–∫–ª—é–∑–∏–∏

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–∏—Ç–æ–≥–æ–≤—ã–µ –≤–µ—Å–∞):

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –í–µ—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|-----|------------|
| –†–∞–∑–º–µ—Ä –º—è—á–∞ | 50% | –û—Å–Ω–æ–≤–Ω–æ–π –∫—Ä–∏—Ç–µ—Ä–∏–π |
| –û–∫–∫–ª—é–∑–∏—è —Å–µ—Ç–∫–æ–π | **–¥–æ 50%** | **–£—Å–∏–ª–µ–Ω–æ!** |
| Y-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ | 15-20% | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π |

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **FIXED.md** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏
- **LOGIC_EXPLAINED.md** - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
- **UPDATES.md** - –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **position_analyzer.py** - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ê–Ω–∞–ª–∏–∑ —Å –Ω–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
./analyze.sh –≤–∞—à–µ_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.jpg

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
for i in {0..4}; do
    ./analyze.sh datasets/merged_ball_dataset/images/test/test_$(printf "%06d" $i).jpg
done

# 3. –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
ls -lh test_occlusion_*.jpg
```

---

**–í–µ—Ä—Å–∏—è:** 2.1  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
**–£–ª—É—á—à–µ–Ω–∏—è:** –£—Å–∏–ª–µ–Ω–Ω–∞—è –æ–∫–∫–ª—é–∑–∏—è + –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∏
