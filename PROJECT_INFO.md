# Информация о проекте

## Описание

Приложение для определения положения мяча относительно сетки на изображениях и видео.

## Что было создано

### Основные модули (Python)

1. **ball_detector.py** - Детекция мяча с использованием YOLO
   - Класс `BallDetector` с методами `detect()` и `get_ball_center()`
   - Поддержка предобученных и кастомных моделей YOLO

2. **net_detector.py** - Детекция сетки на изображении
   - Класс `NetDetector` с тремя методами детекции:
     - `hough` - преобразование Хафа (для четких линий)
     - `contour` - поиск контуров (для явных границ)
     - `color` - цветовая сегментация (для белых сеток)

3. **position_analyzer.py** - Анализ положения мяча относительно сетки
   - Класс `PositionAnalyzer`
   - Определение: "За сеткой" или "Перед сеткой"
   - Оценка уверенности в детекции
   - Визуализация результатов

### Приложения

4. **main.py** - GUI приложение (PyQt5)
   - Загрузка изображений и видео
   - Выбор модели YOLO
   - Настройка параметров детекции
   - Интерактивная визуализация результатов

5. **cli.py** - CLI приложение
   - Обработка изображений и видео из командной строки
   - Гибкие параметры
   - Пакетная обработка
   - Вывод статистики

### Вспомогательные скрипты

6. **train_yolo.py** - Обучение модели на собственных датасетах
   - Автоматизированное обучение YOLO
   - Валидация и метрики
   - Создание конфигурационных файлов

7. **test_app.py** - Тестирование модулей
   - Создание синтетических тестовых изображений
   - Проверка всех компонентов
   - Демонстрация работы

### Документация

8. **README.md** - Основная документация
   - Установка и настройка
   - Описание возможностей
   - Инструкции по использованию

9. **QUICKSTART.md** - Быстрый старт
   - Пошаговые инструкции для начала работы
   - Решение типовых проблем

10. **EXAMPLES.md** - Примеры использования
    - 10 детальных примеров
    - Различные сценарии использования
    - Интеграция в другие проекты

11. **requirements.txt** - Зависимости проекта

12. **.gitignore** - Исключения для Git

## Структура проекта

```
/home/sergii/PycharmProjects/Net/
├── ball_detector.py       # Детекция мяча (YOLO)
├── net_detector.py        # Детекция сетки
├── position_analyzer.py   # Анализ положения
├── main.py               # GUI приложение
├── cli.py                # CLI приложение
├── train_yolo.py         # Обучение модели
├── test_app.py           # Тестирование
├── requirements.txt      # Зависимости
├── README.md            # Документация
├── QUICKSTART.md        # Быстрый старт
├── EXAMPLES.md          # Примеры
├── PROJECT_INFO.md      # Этот файл
├── .gitignore           # Git исключения
├── .venv/               # Виртуальное окружение
└── datasets/            # Датасеты (создается при необходимости)
```

## Технологии

- **Python 3.8+**
- **YOLOv8** (ultralytics) - детекция объектов
- **OpenCV** - обработка изображений
- **PyQt5** - графический интерфейс
- **NumPy** - математические операции
- **PyTorch** - бэкенд для YOLO

## Основные возможности

✅ Детекция мяча с помощью YOLO
✅ Обнаружение сетки (3 метода)
✅ Определение положения мяча (перед/за сеткой)
✅ GUI и CLI интерфейсы
✅ Обработка изображений
✅ Обработка видео
✅ Обучение на собственных датасетах
✅ Визуализация результатов
✅ Оценка уверенности
✅ Пакетная обработка

## Workflow использования

### Сценарий 1: У вас есть обученная модель

```
1. Установите зависимости: pip install -r requirements.txt
2. Запустите: python main.py
3. Загрузите изображение и свою модель
4. Анализируйте
```

### Сценарий 2: Нужно обучить модель

```
1. Подготовьте датасет в формате YOLO
2. Создайте data.yaml: python train_yolo.py --create-example
3. Обучите модель: python train_yolo.py --data data.yaml --epochs 100
4. Используйте: python cli.py image.jpg --model runs/detect/ball_detector/weights/best.pt
```

### Сценарий 3: Пакетная обработка видео

```
1. Используйте CLI для автоматизации
2. python cli.py video.mp4 --video --model model.pt
3. Получите обработанное видео с визуализацией
```

## Формат датасетов YOLO

Приложение работает с датасетами в стандартном формате YOLO:

```
dataset/
├── images/
│   ├── train/  (изображения для обучения)
│   ├── val/    (изображения для валидации)
│   └── test/   (изображения для тестирования)
└── labels/
    ├── train/  (разметка .txt)
    ├── val/
    └── test/
```

Формат файла разметки (.txt):
```
class_id x_center y_center width height
```
Все координаты нормализованы (0-1).

Пример:
```
0 0.5 0.6 0.1 0.15
```

## Алгоритм работы

1. **Загрузка изображения/видео**
2. **Детекция мяча через YOLO**
   - Предсказание bbox мяча
   - Вычисление центра мяча
3. **Детекция сетки**
   - Поиск вертикальной линии одним из методов
   - Определение X-координаты сетки
4. **Анализ положения**
   - Сравнение X-координаты мяча и сетки
   - Анализ окклюзии (перекрытия)
   - Вычисление уверенности
5. **Визуализация**
   - Зеленый bbox - перед сеткой
   - Красный bbox - за сеткой
   - Голубая линия - сетка

## Параметры настройки

### Детекция мяча
- `confidence` - порог уверенности (0.0-1.0)
- `model_path` - путь к модели YOLO

### Детекция сетки
- `method` - метод детекции (hough/contour/color)
- Параметры в `net_detector.py` (пороги, размеры)

### Анализ положения
- `camera_position` - положение камеры (side/front)
- Логика в `position_analyzer.py`

## Примеры команд

```bash
# Тестирование
python test_app.py

# GUI
python main.py

# CLI - изображение
python cli.py image.jpg --confidence 0.6 --net-method hough

# CLI - видео
python cli.py video.mp4 --video --model my_model.pt --output result.mp4

# Обучение
python train_yolo.py --data data.yaml --epochs 100 --batch 16
```

## Расширение функционала

### Добавление нового метода детекции сетки

Отредактируйте `net_detector.py`, добавьте новый метод:

```python
def _detect_by_my_method(self, image):
    # Ваш код
    return (x1, y1, x2, y2)
```

### Изменение логики определения положения

Отредактируйте `position_analyzer.py`, метод `analyze_position()`:

```python
def analyze_position(self, ball_center, ball_bbox, net_x, image_shape):
    # Ваша логика
    return BallPosition.BEHIND_NET  # или IN_FRONT_OF_NET
```

### Добавление новых классов объектов

При обучении модели добавьте классы в `data.yaml`:

```yaml
nc: 2
names: ['ball', 'player']
```

## Производительность

- **YOLOv8n** (nano): ~5-10 FPS на CPU, ~30-50 FPS на GPU
- **YOLOv8s** (small): ~3-7 FPS на CPU, ~25-40 FPS на GPU
- **YOLOv8m** (medium): ~2-5 FPS на CPU, ~20-30 FPS на GPU

Детекция сетки: ~1-3 мс на изображение

## Поддержка форматов

### Изображения
- JPG/JPEG
- PNG
- BMP

### Видео
- MP4
- AVI
- MOV
- MKV

## Лицензия

MIT License - свободное использование и модификация

## Контакты и поддержка

Для вопросов и предложений создавайте issues в репозитории проекта.

## Следующие шаги

1. ✅ Установите зависимости
2. ✅ Запустите тесты
3. ✅ Попробуйте на тестовом изображении
4. ⬜ Протестируйте на своих данных
5. ⬜ При необходимости обучите модель
6. ⬜ Интегрируйте в свой проект

---

**Дата создания проекта:** 2025-11-11
**Версия:** 1.0.0
**Статус:** Готов к использованию
